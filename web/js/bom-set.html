<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <title>Timer - Browser Object Model</title>
  <link rel="stylesheet" href="../../css/common.css">
  <base target="_blank">
</head>

<body>
  <header>
    <h1>定时器</h1>
    <span>&commat;Timer</span>
  </header>
  <dl>
    <dt>说明</dt>
    <dd>.高频事件</dd>
    <dd>.可以定时触发，也可以延迟触发；时间单位是毫秒；需要执行的业务以回调函数 callback 的形式给出；</dd>
    <dd>.为节省系统开销，事件处理完毕应清除定时器；需指定 id</dd>
    <dd>
      <table>
        <tr>
          <th>类别</th>
          <th>说明</th>
        </tr>
        <tr>
          <td>setInterval()</td>
          <td>按照时间间隔定时执行</td>
        </tr>
        <tr>
          <td>clearInterval()</td>
          <td>清除定时器</td>
        </tr>
        <tr>
          <td>setTimeout()</td>
          <td>延迟执行；仅执行1次</td>
        </tr>
        <tr>
          <td>clearTimeout()</td>
          <td>清除延迟</td>
        </tr>
      </table>
      <pre>
//固定时间间隔触发函数：setInterval
let timeId = setInterval(cb, [time]);
clearInterval(timeId)</pre>
      <pre>
//定时/延迟触发函数：setTimeout
let timeId = setTimeout(cb, [time]);
clearTimeout(timeId)</pre>
    </dd>
    <dd>[<span class="iconfont icon-keyboard"></span>] 数字时钟</dd>
    <dd>. 原生实现</dd>
    <dd>. <a href="http://momentjs.cn/" target="_blank" class="link">momentjs</a>实现</dd>
    <dd style="text-align: center;">
      <span id='yy'></span>-<span id='mon'></span>-<span id='day'></span>
      <span id='week'></span>
      <span class="timer-txt"></span>
    </dd>
    <dd>
      <pre>
let week_arr = ['星期日', '星期一', '星期二', '星期三', '星期四', '星期五', '星期六']
let year = document.querySelector('#yy');
let mon = document.querySelector('#mon');
let day = document.querySelector('#day');
let week = document.querySelector('#week');
let timerTxt = document.querySelector('.timer-txt');
let inter = setInterval(clock, 1000)
function clock() {
  let date = new Date();
  year.innerHTML = date.getFullYear();
  mon.innerHTML = date.getMonth() + 1;
  day.innerHTML = date.getDate();
  week.innerHTML = week_arr[date.getDay()];
  timerTxt.innerHTML = double2(date.getHours()) + ':' + double2(date.getMinutes()) + ':' + double2(date.getSeconds());
}
function double2(num) {
  return num > 9 ? num : '0' + num;
}
clock();</pre>
    </dd>
    <dd>[<span class="iconfont icon-keyboard"></span>] 图片时钟</dd>
    <dd>. 通过更改&lt;img&gt;的src切换图片</dd>
    <dd>. 不断向服务器请求图片</dd>
    <dd>
      <pre>
time.split('').forEach((num, ind) => {
  imgs[ind].style.backgroundImage = `url(../imgs/number/number-${num}.png)`;
})</pre>
    </dd>
    <dd>[<span class="iconfont icon-keyboard"></span>] 更多数字时钟案例 <a href="../demo/clock.html">Clock</a>、<a
        href="../demo/clock_adv.html">Clock</a>、<a href="https://codepen.io/glpla/full/poYjBZY">Clock -
        CodePen</a></dd>
    <dd>
      <pre>
.clock div::before {
  content: '';
  position: absolute;
  left: 50%;
  top: 0;
  transform: translateX(-50%);
}

.hour::before {
  width: 4px;
  margin-top: 30%;
  height: 25%;
  background-color: #000;
}

.min::before {
  width: 2px;
  margin-top: 20%;
  height: 35%;
  background-color: #ff0;
}

.sec::before {
  width: 1px;
  margin-top: 10%;
  height: 45%;
  background-color: #fff;
}</pre>
      <pre>
let date, h, m, s;
let oHour = document.querySelector('.hour');
let oMin = document.querySelector('.min');
let oSec = document.querySelector('.sec');
function getTime() {
  date = new Date();
  h = date.getHours() * 30;
  m = date.getMinutes() * 6;
  s = date.getSeconds() * 6;
  oHour.style.transform = `rotateZ(${h + m / 12}deg)`;
  oMin.style.transform = `rotateZ(${m}deg)`;
  oSec.style.transform = `rotateZ(${s}deg)`;

}
getTime();
let tId = setInterval(getTime, 1000);</pre>
    </dd>
    <dd>[<span class="iconfont icon-keyboard"></span>] 日期倒计时</dd>
    <dd style="text-align: center;">
      <span id="ref-time" data-time="2022-09-10">距离2024-12-31 00:00:00还有</span><br>
      <span><span id="cd"></span>天<span id="ch"></span>小时<span id="cm"></span>分钟<span id="cs"></span>秒</span>
    </dd>
    <dd>[<span class="iconfont icon-keyboard"></span>] 秒表倒计时</dd>
    <dd style="text-align: center;">
      <span id="cds">10</span><br>
      <span>10秒倒计时</span>
    </dd>
  </dl>
  <iframe src="../../common/footer.html" frameborder="0" scrolling="no" title="footer" id="footer"></iframe>
  <script>
    // clock
    let week_arr = ['星期日', '星期一', '星期二', '星期三', '星期四', '星期五', '星期六']
    let year = document.querySelector('#yy');
    let mon = document.querySelector('#mon');
    let day = document.querySelector('#day');
    let week = document.querySelector('#week');
    let timerTxt = document.querySelector('.timer-txt');
    let inter = setInterval(clock, 1000)
    function clock() {
      let date = new Date();
      year.innerHTML = date.getFullYear();
      mon.innerHTML = date.getMonth() + 1;
      day.innerHTML = date.getDate();
      week.innerHTML = week_arr[date.getDay()];
      timerTxt.innerHTML = double2(date.getHours()) + ':' + double2(date.getMinutes()) + ':' + double2(date.getSeconds());
    }
    function double2(num) {
      return num > 9 ? num : '0' + num;
    }
    clock();

    // count down
    let cd = document.querySelector('#cd');
    let ch = document.querySelector('#ch');
    let cm = document.querySelector('#cm');
    let cs = document.querySelector('#cs');
    let oldday = new Date('2024-12-31 00:00:00');
    let cinter = setInterval(cdown, 1000);
    function cdown() {
      let newday = new Date()
      let secs = parseInt((oldday - newday) / 1000)
      if (secs < 0) {
        clearInterval(cinter)
        return
      }
      cd.innerHTML = parseInt(secs / 60 / 60 / 24)
      ch.innerHTML = parseInt(secs / 60 / 60 % 24)
      cm.innerHTML = parseInt(secs / 60 % 60)
      cs.innerHTML = secs % 60 > 9 ? secs % 60 : '0' + secs % 60
    }
    cdown()

    // cds
    let cds = document.querySelector('#cds')
    let time = 10
    let cdsinter = setInterval(() => {
      time--
      if (time < 0) {
        clearInterval(cdsinter)
        return
      }
      cds.innerHTML = time
    }, 1000)
  </script>
</body>

</html>