<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <title>滚动 Scroll</title>
  <link rel="stylesheet" href="../../css/common.css">
  <base target="_blank">
</head>

<body>
  <header>
    <h1>滚动</h1>
    <span>&commat;Scroll</span>
  </header>
  <dl>
    <dd>.元素的内容超过元素的大小，且出现滚动条时|不能溢出隐藏，才会有相应的变化</dd>
    <dd>.通常处理HTML页面的滚动，也可以处理某个特定元素的滚动</dd>
    <dd>.通常处理垂直方向的应用</dd>
    <dd>
      <figure class="img-sn">
        <img src="../imgs/dom.jpg" alt="">
        <figcaption>滚动区域</figcaption>
      </figure>
    </dd>
    <dd>.没有滚动时，scrollTop为0，滚动比例为0</dd>
    <dd>.滚动到最下面时，scrollTop为最大，滚动比例为1</dd>
    <dd>.利用这个比值，可以做一些特别设计</dd>
    <dd>1. 获取文档对象 - 返回文档document的根元素root element；对HTML文档来说，就是&lt;html&gt;</dd>
    <dd>
      <pre>let html = document.documentElement</pre>
    </dd>
    <dd>2. 获取文档视口高度 - 和浏览器有关，如缩放，调试时选择不同的设备等都可以影响视口大小</dd>
    <dd>
      <pre>let clientHeight = html.clientHeight</pre>
    </dd>
    <dd>3. 获取文档可滚动高度 - el.scrollHeight：可以滚动的高度；通常获取body的可滚动高度</dd>
    <dd>
      <pre>let scrollHeight = html.scrollHeight || document.body.scrollHeight</pre>
    </dd>
    <dd>4. 获取文档滚动高度 - el.scrollTop：元素垂直滚动的数值：the number of pixels that an element's content is scrolled vertically.</dd>
    <dd>
      <pre>let scrollTop = html.scrollTop || document.body.scrollTop</pre>
    </dd>
    <dd class="tips">
      <div>When scrollTop is used on the root element (the &lt;html&gt; element), the scrollY of the window is returned.
        This
        is a special case of scrollTop</div>
      <div>window.scrollY：是BOM中window对象的属性，滚动的距离；同scrollTop</div>
      <div>可以根据这个动态设置元素样式，如视觉差、返回顶部；IE不支持</div>
    </dd>
    <!-- <dd>为了跨浏览器兼容性，请使用 window.pageYOffset 而不是 window.scrollY</dd> -->
    <dd>方案1：利用DOM元素：滚动事件添加在元素上</dd>
    <dd>
      <pre>
let html = document.documentElement;
document.addEventListener('scroll', () => {
let per = html.scrollTop / (html.scrollHeight - html.clientHeight);
console.log(per);})</pre>
    </dd>
    <dd>方案2：利用BOM元素：滚动事件添加在window上</dd>
    <dd>
      <pre>
window.addEventListener('scroll', fn);
window.addEventListener('resize', fn);
window.addEventListener('load', fn);
function fn() {
  let top = document.documentElement.scrollTop | document.body.scrollTop;
  console.log(top);
  console.log(window.scrollY);
}</pre>
    </dd>
  </dl>
  <div class="chap">应用 Cases</div>
  <dl>
    <dd>[<span class="iconfont icon-keyboard"></span>]<a href="../demo/parallax.html" class="link">视觉差</a> -
      将滚动值转化为元素的定位属性</dd>
    <dd>
      <pre>
window.addEventListener('scroll', () => {
  let val = window.scrollY;
  tree0.style.left = -val * 0.25 + 'px';
  tree1.style.left = -val * 0.5 + 'px';
  tree2.style.right = -val * 0.25 + 'px';
  tree3.style.marginLeft = -val * 0.5 + 'px';
  h1.style.marginTop = val + 'px';
})      </pre>
    </dd>
    <dd>[<span class="iconfont icon-keyboard"></span>]<a href="../demo/scroll.html" class="link">滚动显示</a> -
      将滚动值转化为元素的透明、缩放、位移等属性</dd>
    <dd>
      <pre>
let lis = document.querySelectorAll('li');
let html = document.documentElement;
document.addEventListener('scroll', () => {
  let per = html.scrollTop / (html.scrollHeight - html.clientHeight);

  let total = 1 / lis.length;
  for (let [index, li] of lis.entries()) {
    let start = total * index;
    let end = total * (index + 1);
    let pro = (per - start) / (end - start);
    if (pro >= 1) pro = 1;
    if (pro &lt;= 0) pro = 0;
    li.style.setProperty('--per', pro);
  }
})      </pre>
    </dd>
    <dd>[<span class="iconfont icon-keyboard"></span>] <a href="https://codepen.io/glpla/full/QWojbYE">使用须知notice -
        CodePen</a>、<a href="../demo/notice.html">使用须知notice</a></dd>
    <dd>.阅读完才可以继续下一步</dd>
    <dd>
      <pre>
let tips = document.querySelector('.tips');
let btn = document.querySelector('.btn');
tips.addEventListener('scroll', () => {
  let per = tips.scrollTop / (tips.scrollHeight - tips.offsetHeight);
  if (per >= 0.9) {
    btn.removeAttribute('disabled');
    btn.classList.add('active');
  }
})</pre>
    </dd>
    <dd>[<span class="iconfont icon-keyboard"></span>] <a href="https://codepen.io/glpla/full/eYXpNqe">水平进度条 -
        CodePen</a></dd>
    <dd>.水平方向的应用</dd>
    <dd>[<span class="iconfont icon-keyboard"></span>]下拉刷新 - 当滚动到一定程度时，如70%，加载更多数据</dd>
  </dl>
  <iframe src="../../common/footer.html" frameborder="0" scrolling="no" title="footer" id="footer"></iframe>
</body>

</html>