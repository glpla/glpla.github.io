<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CSS变量 Variable</title>
  <link rel="stylesheet" href="../css/common.css">
  <base target="_blank">
  <style>
    :root {
      --main-color: #01b4ff;
      --main-layout: repeat(3, 1fr);
    }

    :root[data-theme="blue"] {
      --main-color: #01b4ff;
    }

    :root[data-theme="purple"] {
      --main-color: #be01fe;
    }

    :root[data-theme="red"] {
      --main-color: #ff0f5b;
    }

    header {
      background-image: linear-gradient(315deg, var(--main-color) 25%, #647eff);
    }

    .mixer span {
      display: inline-block;
      width: 20px;
      height: 20px;
      border: 1px solid #fff;
      cursor: pointer;
    }

    .wrap {
      display: grid;
      grid-template-columns: var(--main-layout);
    }

    dt {
      position: relative;
      color: var(--main-color);
      display: flex;
      align-items: center;
    }

    dt::after {
      content: '';
      flex: 1;
      height: 1px;
      background-color: var(--main-color);
    }

    @media screen and (max-width:768px) {
      :root {
        --main-layout: 1fr;
      }
    }
  </style>
</head>

<body>
  <header>
    <h1>变量&commat;Variable</h1>
    <div class="mixer">
      <span data-color="#ff0f5b" style="background-color: #ff0f5b;"></span>
      <span data-color="#be01fe" style="background-color: #be01fe;"></span>
      <span data-color="#01b4ff" style="background-color: #01b4ff;"></span>
    </div>
  </header>
  <dl>
    <dt>说明</dt>
    <dd>. 也称自定义属性</dd>
    <dd>. 声明：使用两个短划线--开始的变量名表示</dd>
    <dd>. 使用：在CSS中使用var()引用变量；可以指定备用值</dd>
    <dd>. 一次定义、多次使用；适合一个属性值在多处被使用；相当于定义了一个当前CSS文件内的全局变量</dd>
    <dd>. 优势：方便运维，特别适合全站换肤</dd>
    <dd>. 变量的使用经常配合计算函数 calc() 使用</dd>
    <dt>全局变量</dt>
    <dd>
      <div>. 在CSS中，使用根选择器:root声明，所有元素都可使用</div>
      <pre>
:root {
    --main-color: #f40;
    --main-layout: repeat(3, 1fr);
}

.wrap {
    display: grid;
    grid-template-columns: var(--main-layout);
    color: var(--main-color, #fff);
}

@media screen and (max-width:768px) {
    :root {
        --main-layout: 1fr;
    }
}</pre>
    </dd>
    <dt>局部变量</dt>
    <dd>
      <div>. 在CSS中，如果变量定义在某个选择器，则只有该选择器选中的元素和它的所有后代元素使用-局部变量</div>
      <pre>
.wrap{
    --el-color: #890;
}</pre>
    </dd>
    <dt>内联变量</dt>
    <dd>
      <div>. 在HTML元素中，使用style定义内联CSS变量，供当前元素在CSS使用</div>
      <pre>&lt;div style="--alpha:0"&gt;0&lt;/div&gt;</pre>
      <pre>
el{
  opacity: var(--alpha);
}      </pre>
    </dd>
    <dd class="mt2">[<span class="iconfont icon-keyboard"></span>] <a href="./opening.html#evaluation">教学评价</a></dd>
    <dd>
      <div>. 每个评价条目仅仅是百分比和提示信息不同</div>
      <div>. 使用伪元素分别显示百分比和提示信息</div>
      <pre>
&lt;div class="grid">
  &lt;div class="per" style="--per:10%;" data-cont="考勤10%"&gt; &lt;/div&gt;
  &lt;div class="per" style="--per:30%;" data-cont="作业30%"&gt; &lt;/div&gt;
  &lt;div class="per" style="--per:60%;" data-cont="考试60%"&gt; &lt;/div&gt;
&lt;/div&gt;
      </pre>
      <pre>
.per::before {
  content: '';
  width: var(--per);
  height: 100%;
  border-radius: 2rem;
  background-color: #f40;
  transform-origin: left center;
}

.per::after {
  content: attr(data-cont);
  color: #f40;
  margin-right: 1rem;
}      </pre>
    </dd>
    <dt>与JS交互</dt>
    <dd>
      <div>. 动态调整</div>
      <div>. 获取元素节点，使用其特定属性，如颜色去修改变量的值，达到换肤的效果</div>
      <div>. 也可以使用自定义属性绑定颜色值</div>
      <pre>
let mixer = document.querySelectorAll('.mixer span');
let root = document.querySelector(':root');
mixer.forEach(item => {
    item.addEventListener('click', (e) => {
        console.log(e.target.style.backgroundColor);
        root.style.setProperty('--main-color', e.target.style.backgroundColor)
    })
})</pre>
    </dd>
  </dl>
  <iframe src="../../common/footer.html" frameborder="0" scrolling="no" title="footer" id="footer"></iframe>
  <script>
    let mixer = document.querySelectorAll('.mixer span');
    let root = document.querySelector(':root');
    mixer.forEach(item => {
      item.addEventListener('click', (e) => {
        // console.log(e.target.style.backgroundColor);
        console.log(e.target);
        console.log(e.target.getAttribute('data-color'));
        root.style.setProperty('--main-color', e.target.style.backgroundColor)
      })
    })
  </script>
</body>

</html>