<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>代码托管 Git</title>
    <link rel="stylesheet" href="../css/common.css">
    <base target="_blank">
    <style>
        :root {
            --main-color: #4bc2ce;
            --warn-color: #1b9fab;
            --tbl-color-light: #edf9fa;
        }
    </style>
</head>

<body>
    <header>
        <h1>版本管理</h1>
        <span>&commat;Git</span>
        <span class="ham"></span>
        <nav class="nav">
            <a href="" style="--delay:0" class="nav-item">概述</a>
            <a href="" style="--delay:1" class="nav-item">工作流</a>
            <a href="" style="--delay:2" class="nav-item">基本使用</a>
            <a href="" style="--delay:3" class="nav-item">仓库</a>
            <a href="" style="--delay:4" class="nav-item">分支</a>
        </nav>
    </header>
    <dl class="nav-cont">
        <dd>. 代码仓库管理工具</dd>
        <dd>. 分布式版本控制系统</dd>
        <dt>下载和安装</dt>
        <dd>. 打开 Git 官网 <a href="https://git-scm.com/" class="link">https://git-scm.com/</a>，选择对应的操作系统和版本，点击下载并安装</dd>
        <dt>查看 Git 版本</dt>
        <dd>
            <div>. 右键点击桌面空白处，选择 Git Bash Here，打开终端窗口，输入以下命令</div>
            <pre>
$ git --version
git version 2.34.1.windows.1</pre>
        </dd>
        <dd class="tips">Git Bash 就是一个迷你型的 Linux 系统哦</dd>
        <dt>配置 Git</dt>
        <dd>
            <div>. 使用户名和邮箱将 Git 和用户[自己的代码仓库，如 Github ]关联起来</div>
            <div>. 用户名和邮箱仅仅作为签名，以区分提交的用户，和仓库账号没有关系 - 仅用于提交记录，不涉及登录或权限</div>
            <div>. 没有关联，无法提交 commit</div>
            <div>--system：系统级别的配置</div>
            <div>--global：全局级别的配置；建议</div>
            <div>--local：项目本地的配置；默认</div>
            <pre>
$ git config --global user.email 1942194789@qq.com
$ git config --global user.name glpla</pre>
        </dd>
        <dt>查看 Git 配置</dt>
        <dd>
            <pre>
cnplaman@LAPTOP-QL08LD1S MINGW64 ~/Desktop
$ git config  user.name
cnplaman

cnplaman@LAPTOP-QL08LD1S MINGW64 ~/Desktop
$ git config  user.email
1942194789@qq.com</pre>
        </dd>
    </dl>
    <div class="chap">工作流 workflow</div>
    <dl class="nav-cont">
        <dd>
            <figure class="img-sn">
                <img src="./imgs/git.jpg" alt="">
                <figcaption>Git工作流</figcaption>
        </dd>
        <dt>工作区 workspace</dt>
        <dd>
            <div>存放项目文件的地方，通常就是你的项目工作目录</div>
            <div>利用 add 可以将文件从工作区放到暂存区</div>
            <div>点 . 表示所有文件；也可以指定需要提交的具体的文件；不包括被忽略的文件</div>
            <div>单个文件体积大小不要超过50MB</div>
            <pre>$ git add .</pre>
        </dd>
        <dt>暂存区 stage</dt>
        <dd>
            <div>临时存放文件便于调整</div>
            <div>利用 commit 可以将文件从暂存区放到本地仓库区/版本区</div>
            <div>每次提交都有一个 commitId 记录</div>
            <pre>$ git commit -m ""</pre>
        </dd>
        <dt>本地仓库区 local repository</dt>
        <dd>
            <div>版本区</div>
            <div>文件只有放到了版本区才可以进行真正意义上的管理</div>
            <div>将本地分支的提交推送到远程仓库对应的分支 - 不仅要指定推送的仓库/别名，还要指定推送到哪个分支</div>
            <div>具体行为取决于当前分支是否已经设置了上游 upstream 分支</div>
            <pre>$ git push &lt;name&gt; &lt;branch&gt;</pre>
            <div>将本地的 branch 分支推送到远程仓库 name 的 branch 分支；不会设置任何追踪关系</div>
            <div>后续如果要推送或拉取这个分支，<span class="warn">仍然</span>需要明确指定远程仓库和分支名称</div>
            <div>方便起见，使用 -u/--set-upstream 设置一个追踪关系 upstream relationship / 自动关联</div>
            <pre>$ git push -u &lt;name&gt; &lt;branch&gt;</pre>
            <div>后续只需要使用 git push 即可推送</div>
            <pre>$ git push</pre>
            <div>从版本区也可以切换回去工作区，使用 git reset --hard命令</div>
        </dd>
        <dt>远程仓库区 remote repository</dt>
        <dd>线上仓库，如GitHub、Gitee</dd>
    </dl>
    <div class="chap">常见使用 usage</div>
    <dl class="nav-cont">
        <dt>初始化仓库 init</dt>
        <dd>
            <div>为当前工作目录生成一个隐藏文件夹 .git，里面是 Git 配置信息</div>
            <div>初始化后，该目录将被 Git 托管，可以追踪代码的任何变化</div>
            <div>如果生成的 .git 被删除，有关的托管信息将丢失</div>
            <div>具体的配置文件 .gitconfig 位于系统盘用户目录下：C:\Users\cnplaman</div>
            <div>文件内容就是 Git 配置的用户邮箱等基本信息</div>
            <pre>$ git init</pre>
        </dd>
        <dt>查看文件状态 status</dt>
        <dd>
            <pre>$ git status</pre>
            <table>
                <caption>Git文件状态</caption>
                <tr>
                    <th>item</th>
                    <th>desc</th>
                </tr>
                <tr>
                    <td>untracked</td>
                    <td>未记录的；VS code 中使用标记 U</td>
                </tr>
                <tr>
                    <td>modified</td>
                    <td>修改过的；VS code 中使用标记 M</td>
                </tr>
                <tr>
                    <td>staged</td>
                    <td>已暂存的</td>
                </tr>
                <tr>
                    <td>committed</td>
                    <td>已提交的</td>
                </tr>
            </table>
        </dd>
        <dt>查看本地仓库提交记录 log</dt>
        <dd>
            <div>按 Q/q 退出</div>
            <pre>
$ git log
commit cc355cbd2a03d61f0ef440706fee7c6257f9fee3 (HEAD -> main, origin/main, origin/HEAD)
Author: glpla &lt;1942194789@qq.com>
Date:   Wed Jan 3 12:34:20 2024 +0800

    web

commit 32eefc91550a970775689f1f2a7b239bd2b22753
Author: glpla &lt;1942194789@qq.com>
Date:   Wed Jan 3 10:48:20 2024 +0800

    web</pre>
        </dd>
        <dt>查看远程仓库提交记录 reflog</dt>
        <dd>
            <div>按 Q/q 退出</div>
            <div>main 总是指向最新的提交；而 HEAD 指向当前的活动分支；如果没有分支，就指向主分支 main</div>
            <div>HEAD 前面的字符串序列是提交的版本号；利用这个可以实现版本穿梭</div>
            <div>示例中没有分支，所以 HEAD 指向主分支 main</div>
            <pre>
$ git reflog
cc355cb (HEAD -> main, origin/main, origin/HEAD) HEAD@{0}: commit: web
32eefc9 HEAD@{1}: commit: web
aae5d51 HEAD@{2}: commit: web
065c08e HEAD@{3}: commit: fn</pre>
        </dd>
        <dt>撤销本地修改 checkout</dt>
        <dd>
            <div>丢弃工作区的修改</div>
            <div>修改了文件，但是没有 add 到暂存区，使用该命令可以撤销对文件的修改，相当于在编辑环境中使用了 CTRL + Z 操作</div>
            <div>修改了文件，已经 add 到暂存区，使用该命令，可以拉取暂存区的文件到工作区，覆盖当前文件，相当于放弃了对文件的修改，即和暂存区保持一致</div>
            <pre>$ git checkout -- file</pre>
        </dd>
        <dt>撤销本地/远程提交 reset</dt>
        <dd>
            <div>--mixed：默认行为；撤销最近一次提交，并将更改回退到工作区 - 取消暂存</div>
            <div>撤销本地提交</div>
            <pre>$ git reset commitId</pre>
            <div>--soft：撤销最近一次提交，但保留工作区和暂存区的更改，不希望丢失任何更改</div>
            <pre>$ git reset --soft HEAD~1</pre>
            <div>撤销远程提交 - 版本穿梭</div>
            <div>--hard：撤销最近一次提交，并完全丢弃更改，恢复到上一个提交的状态</div>
            <pre>$ git reset --hard HEAD~1</pre>
            <pre>
git reset --hard 版本号

Head is now at xxxxx</pre>
        </dd>
    </dl>
    <div class="chap">仓库</div>
    <dl class="nav-cont">
        <dt>克隆仓库 clone</dt>
        <dd>
            <div>将远程仓库复制到本地</div>
            <div>通常是第一次使用别人的仓库；后续直接拉取 pull 就可以和仓库保持一致</div>
            <pre>$ git clone url</pre>
        </dd>
        <dt>拉取仓库 pull</dt>
        <dd>
            <div>在第一次克隆 clone 的基础上，通过拉取和原来仓库保持一致</div>
            <div>如果之前提交使用 -u 设置了追踪，可以直接拉取</div>
            <pre>$ git pull &lt;name&gt; &lt;branch&gt;</pre>
            <pre>$ git pull</pre>
        </dd>
        <dt>仓库管理 remote</dt>
        <dd>
            <div>git remote 命令用于管理和查看 Git 仓库中的远程仓库配置。它有多种用法，具体取决于你提供的参数</div>
            <div>1. 查看关联的远程仓库 remote</div>
            <pre>
git remote
origin</pre>
            <div>使用 -v 参数查看关联仓库的详细信息</div>
            <pre>
git remote -v
origin  https://github.com/glpla/glpla.github.io.git (fetch)
origin  https://github.com/glpla/glpla.github.io.git (push)</pre>
            <div>2. 添加远程仓库 add</div>
            <div>使用 add 添加/关联远程仓库并指定一个 <span class="warn">别名</span> - 因为仓库 url 太长</div>
            <div>可以关联多个远程仓库，使用别名区分</div>
            <pre>$ git remote add &lt;name&gt; &lt;url&gt;</pre>
            <div>分别为 Github 和 Gitee 指定别名</div>
            <pre>$ git remote add origin https://github.com/glpla/glpla.github.io.git</pre>
            <pre>$ git remote add gitee https://gitee.com/cnplaman_admin/case1-helloworld.git</pre>
            <div>3. 删除远程仓库 remove</div>
            <pre>$ git remote remove &lt;name&gt;</pre>
            <pre>$ git remote rm &lt;name&gt;</pre>
            <div>4. 重命名远程仓库 rename</div>
            <pre>$ git remote rename &lt;old-name&gt; &lt;new-name&gt;</pre>
            <div>5. 修改远程仓库 set-url</div>
            <pre>$ git remote set-url &lt;name&gt; &lt;new-url&gt;</pre>
        </dd>
    </dl>
    <div class="chap">分支 Branch</div>
    <dl class="nav-cont">
        <dd>通过分支实现项目的分工协作</dd>
        <dd>各分支的操作并不影响主分支；且分支的进度通常要领先于主分支</dd>
        <dd>当分支合并到主分支后，主分支的整个时间线才往前推进，进度才能和分支保持一致</dd>
        <dd>main 总是指向最新的提交；而 HEAD 指向当前的活动分支；如果没有分支，就指向主分支 main</dd>
        <dd>只有提交 commit 过1次后才能查看分支</dd>
        <dd>
            <figure class="img-sn">
                <img src="./imgs/branch2.jpg" alt="">
                <figcaption>无分支时，HEAD指向主分支</figcaption>
            </figure>
            <figure class="img-sn">
                <img src="./imgs/branch0.jpg" alt="">
                <figcaption>分支单独工作，HEAD指向活动分支</figcaption>
            </figure>
            <figure class="img-sn">
                <img src="./imgs/branch1.jpg" alt="">
                <figcaption>分支合并到主分支</figcaption>
            </figure>
        </dd>
        <dt>查看分支</dt>
        <dd>
            <div>当前分支以 * 号表示，且颜色为绿色</div>
            <pre>
//不带参数：查看本地分支
$ git branch
  dev
* master

//查看所有分支
$ git branch -a
dev
* master

//查看分支最近提交信息
$ git branch -v
  dev    29aee33 1st commit
* master 29aee33 1st commit

//查看远程分支
$ git branch -r</pre>
        </dd>
        <dt>创建分支</dt>
        <dd>
            <pre>$ git branch branch_name</pre>
        </dd>
        <dt>切换分支 checkout</dt>
        <dd>
            <div>指定要切换的分支名</div>
            <pre>
$ git checkout dev
Switched to branch 'dev'</pre>
        </dd>
        <dt>合并分支 merge</dt>
        <dd>
            <div>通常在主分支合并其它分支</div>
            <div>将其它分支合并到主分支；主分支会前进一次 forwards</div>
            <div>原有分支仍然存在</div>
            <pre>
$ git merge dev
Updating 29aee33..c9f8938
Fast-forward
 demo.txt | 0
 1 file changed, 0 insertions(+), 0 deletions(-)
 create mode 100644 demo.txt</pre>
        </dd>
        <dt>删除分支</dt>
        <dd>
            <div>指定删除的分支名</div>
            <div>只能在当前分支删除其它分支</div>
            <pre>
$ git branch -d dev
Deleted branch dev (was c9f8938).            </pre>
        </dd>
        <dd>[<span class="iconfont icon-keyboard"></span>] 新项目第一次推送 - 请使用自己的仓库地址</dd>
        <dd>
            <pre>
git init
git add .
git commit -m "first commit"
git branch -M main
git remote add origin url
git push -u origin main</pre>
        </dd>
        <dd>[<span class="iconfont icon-keyboard"></span>] 分支操作</dd>
        <dd>请使用 shell 完成以下操作</dd>
        <dd class="sn">
            <div>创建新文件夹 Demo 作为工作目录</div>
            <div>初始化工作目录</div>
            <div>查看分支</div>
            <div>创建测试文件 test.txt 并 add、commit 提交到本地仓库</div>
            <div>查看分支</div>
            <div>创建分支 dev</div>
            <div>切换至分支 dev</div>
            <div>查看分支</div>
            <div>创建测试文件 demo.txt 并 add、commit 提交到本地仓库</div>
            <div>切换回 master 分支，查看工作目录中文件的变换情况</div>
            <div>合并分支 dev 到主分支</div>
            <div>查看分支</div>
            <div>删除分支 dev</div>
            <div>查看分支</div>
        </dd>
        <dd class="tips">
            <div>冲突</div>
            <div>.主分支提交前进的同时，某一分支也提交。当主分支合并分支时，就会出现冲突</div>
            <div>.尽量避免同时操作同一个文件</div>
            <div>.主分支面向生成环境，应只做阶段性的合并</div>
            <div>.日常工作应使用开发分支和团队分支、个人分支：个人分支合并到团队分支；团队分支合并到开发分支</div>
        </dd>
    </dl>
    <iframe src="../../common/footer.html" frameborder="0" scrolling="no" title="footer" id="footer"></iframe>
    <script src="/utils//custom/ham2024.js"></script>
</body>

</html>