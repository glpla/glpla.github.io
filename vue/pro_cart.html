<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>项目 购物车</title>
  <link rel="stylesheet" href="../css/course.css">
  <link rel="stylesheet" href="../css/sn.css">
  <link rel="stylesheet" href="../css/code.css">
  <base target="_blank">
</head>

<body>
  <div class="container">
    <header>
      <h1>购物车</h1>
      <span>Center</span>
    </header>
    <dl class="number-mul-sn">
      <dt>实验内容</dt>
      <dd>同时使用普通事件和监听实现</dd>
      <dd>
        <div>单个商品的增加和减少</div>
        <div>全选</div>
        <div>地址选择</div>
        <div>结算</div>
        <div>下单</div>
        <div>商品删除</div>
      </dd>
      <dt>前置知识</dt>
      <dd>
        <div>单击事件、改变事件</div>
        <div>网络请求 axios - GET</div>
        <div>计算属性</div>
        <div>侦听器</div>
      </dd>
      <dt>开发环境</dt>
      <dd>
        <div>操作系统 Window 10+</div>
        <div>文本编辑器 Vs Code</div>
        <div>谷歌浏览器 Chrome</div>
        <div>node.js</div>
      </dd>
      <dt>参考代码</dt>
      <dd>这里给出购物车优化后的逻辑；其它逻辑请参考<a href="./drill_cart.html" class="link">购物车</a></dd>
      <dd>
        <p>标记flag辅助判断全选和单选</p>
        <pre class="code">flag=true</pre>
        <div>全选 - 侦听全选标记 selectedAll</div>
        <pre class="code">
watch(() => data.selectedAll, (n, o) => {
  console.log(n);
  if (n) {
    data.selectedLists = data.lists
  } else {
    if (flag)
      data.selectedLists = []
  }
}, { immediate: true })</pre>
        <div>单选 - 侦听已选列表 selectedLists</div>
        <pre class="code">
watch(() => data.selectedLists, (n, o) => {
  console.log(n.length);
  if (n.length == data.lists.length && data.lists.length) {
    data.selectedAll = true
    flag = true
  } else {
    data.selectedAll = false
    flag = false
  }
}, { immediate: true })</pre>
        <div>购物车结算</div>
        <pre class="code">
const getTotal = computed(() => {
  let sum = 0

  //forEach - 进阶遍历
  data.selectedLists.forEach(item => {
    sum += item.number * item.price
  })

  //reduce - 数组归并函数
  sum = data.selectedLists.reduce((pre, cur, index, arr) => pre + cur.number * cur.price, 0)

  return sum
})</pre>
      </dd>
    </dl>
    <iframe src="../../common/footer.html" frameborder="0" scrolling="no" title="footer" id="footer"></iframe>
  </div>
</body>

</html>