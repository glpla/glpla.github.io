<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Axios Backend</title>
  <link rel="stylesheet" href="../css/reset2024.css">
  <link rel="stylesheet" href="../css/common2024.css">
  <link rel="stylesheet" href="../css/code.css">
  <link rel="stylesheet" href="../css/sn.css">
  <base target="_blank">
  <style>
    #dog {
      width: 100%;
      max-width: 600px;
      min-width: 300px;
      aspect-ratio: 16/9;
      margin: 0 auto;
    }
  </style>
</head>

<body>
  <header>
    <h1>Axios</h1>
    <span>Backend</span>
  </header>
  <dl>
    <dt>简介 overview</dt>
    <dd>通用、主流的第三方库；用于获取本地和远程json数据</dd>
    <dd>默认是Promise</dd>
    <dd>支持async/await用法</dd>
    <dd>更多信息，点击访问<a href="https://www.axios-http.cn/" class="link">axios中文网</a></dd>
    <dd>
      <figure class="code">
        <figcaption>Promise - get</figcaption>
        <pre>
axios.get('/user?ID=12345')
  .then((response) => {
    // 处理成功情况
    console.log(response);
  })
  .catch((error) => {
    // 处理错误情况
    console.log(error);
  })
  .finally(() => {
    // 总是会执行
})</pre>
      </figure>
      <figure class="code">
        <figcaption>async/await - get</figcaption>
        <pre>
async function getUser() {
  try {
    const response = await axios.get('/user?ID=12345');
    console.log(response);
  } catch (error) {
    console.error(error);
  }
}        </pre>
      </figure>
      <figure class="code">
        <figcaption>向 axios 传递相关配置来创建请求 - 默认get</figcaption>
        <pre>
axios('/user/12345');</pre>
      </figure>
      <figure class="code">
        <figcaption>向 axios 传递相关配置来创建请求 - get</figcaption>
        <pre>
axios({
  method: 'get',
  url: 'http://bit.ly/2mTM3nY',
  responseType: 'stream'
})
  .then( (response) =>{
    console.log(response)
  });</pre>
      </figure>
      <figure class="code">
        <figcaption>向 axios 传递相关配置来创建请求 - post</figcaption>
        <pre>
axios({
  method: 'post',
  url: '/user/12345',
  data: {
    firstName: 'Fred',
    lastName: 'Flintstone'
  }
});</pre>
      </figure>
    </dd>
    <dt>CDN方式</dt>
    <dd class="code">
      <pre>
&lt;script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"&gt;&lt;/script&gt;</pre>
    </dd>
    <dd class="code">
      <pre>
//get数据
axios
.get('./oa.json')
.then(res => { console.log(res); })</pre>
    </dd>
    <dd class="example-sn">获取远程数据 - 小狗</dd>
    <dd><button id="getDog">点击获取小狗</button></dd>
    <dd id="dog">
      <img src="" alt="">
    </dd>
    <dd class="example-sn">获取远程数据 - 土味情话</dd>
    <dd><button id='axios-re'>点击获取土味情话</button></dd>
    <div id="axios-remote"></div>
    <dd class="example-sn">获取本地数据</dd>
    <dd>1. 如何渲染获取到的数据？使用新节点？使用innerHtml？</dd>
    <dd>2. 表格&lt;table&gt;的使用：使用默认表格还是特别指定表头&lt;thead&gt;和表体&lt;tbody&gt;？</dd>
    <dd><button id='axios'>点击获取WEB知识体系</button></dd>
    <dd class="tbl-box">
      <table class="tbl" cellpadding='6'>
        <thead>
          <tr>
            <th>序号</th>
            <th>内容</th>
            <th>难度</th>
          </tr>
        </thead>
        <tbody id="axios-local"></tbody>
      </table>
    </dd>
    <dd class="code">
      <pre>
//使用节点
for (let i = 0; i &lt; res.data.length; i++) {
let tr = document.createElement('tr')
for (let item in res.data[i]) {
    let td = document.createElement('td')
    td.innerHTML = res.data[i][item]
    tr.appendChild(td)
}
axiosLocal.appendChild(tr)
}</pre>
    </dd>
    <dd class="code">
      <pre>
//使用innerHtml
for (let i = 0; i &lt; res.data.length; i++) {
let tr = '<tr>'
for (let item in res.data[i]) {
    tr += '<td>' + res.data[i][item] + '</td>'
}
tr += '</tr>'
axiosLocal.innerHTML += tr
}</pre>
    </dd>
    <dt>Vue框架</dt>
    <dd>使用npm安装并引入</dd>
    <dd>通常全局安装并引入</dd>
    <dd class="code">
      <pre>npm i axios</pre>
    </dd>
    <dd class="code">
      <pre>import axios from 'axios'</pre>
    </dd>
    <dt>推荐资源</dt>
    <dd>1. 随机小狗 <a href="https://dog.ceo/api/breed/pembroke/images/random">dog ceo</a></dd>
    <dd>2. 随机图片 <a href="https://picsum.photos/" class="link">picsum photos</a></dd>
    <dd>3. 土味情话 <a href="https://api.uomg.com/api/rand.qinghua?format=json"></a></dd>
    <dd>4. http://ajax-base-api-t.itheima.net/api</dd>
    <dd>/getbooks</dd>
    <dd>/addbook</dd>
  </dl>
  <iframe src="../common/footer.html" frameborder="0" scrolling="no" title="footer" id="footer"></iframe>
  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
  <script>
    // remote - dog
    let getDog = document.querySelector('#getDog')
    let dog = document.querySelector('#dog img')
    getDog.addEventListener('click', getDogFn)
    async function getDogFn() {
      let res = await axios('https://dog.ceo/api/breed/pembroke/images/random')
      dog.src = res.data.message
    }
    getDogFn()
    // remote - 土味情话
    let axiosR = document.querySelector('#axios-re')
    let axiosRe = document.querySelector('#axios-remote')
    axiosR.addEventListener('click', getQinghua)
    function getQinghua() {
      axiosRe.innerHTML = ''
      axios
        // .get('https://api.apiopen.top/getJoke?page=1&count=10&type=text')
        .get('https://api.uomg.com/api/rand.qinghua?format=json')
        .then(res => {
          axiosRe.innerHTML = res.data.content
        })
    }
    getQinghua()
    // local
    let axiosL = document.querySelector('#axios')
    let axiosLocal = document.querySelector('#axios-local')
    axiosL.addEventListener('click', () => {
      axiosLocal.innerHTML = ''
      axios
        .get('../../data/data2021/stu.json')
        .then(res => {
          for (let i = 0; i < res.data.length; i++) {
            let tr = document.createElement('tr')
            for (let item in res.data[i]) {
              let td = document.createElement('td')
              td.innerHTML = res.data[i][item]
              tr.appendChild(td)
            }
            axiosLocal.appendChild(tr)
          }
          // for (let i = 0; i < res.data.length; i++) {
          //   let tr = '<tr>'
          //   for (let item in res.data[i]) {
          //     tr += '<td>' + res.data[i][item] + '</td>'
          //   }
          //   tr += '</tr>'
          //   axiosLocal.innerHTML += tr
          // }
        })
    })
  </script>
</body>

</html>