<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>项目 个人中心页</title>
  <link rel="stylesheet" href="../css/common.css">
  <link rel="stylesheet" href="../css/sn.css">
  <base target="_blank">
</head>

<body>
  <header>
    <h1>个人中心页</h1>
    <span>Center</span>
  </header>
  <dl class="number-mul-sn">
    <dt>实验内容</dt>
    <dd>
      <div>头像定制</div>
      <div>信息定制</div>
      <div>收藏</div>
      <div>订单</div>
      <div>评论</div>
      <div>热门推荐</div>
      <div>地址管理</div>
    </dd>
    <dt>前置知识</dt>
    <dd>
      <div>文件上传</div>
      <div>表单提交</div>
      <div>双向绑定</div>
      <div>网络请求 Axios - GET、POST</div>
    </dd>
    <dt>开发环境</dt>
    <dd>
      <div>操作系统 Window 10+</div>
      <div>文本编辑器 Vs Code</div>
      <div>谷歌浏览器 Chrome</div>
      <div>Node.js</div>
    </dd>
    <dd>
      <table>
        <caption>API</caption>
        <tr>
          <th>分类</th>
          <th>命名</th>
        </tr>
        <tr>
          <td>/api/uploadImg</td>
          <td>图像上传接口</td>
        </tr>
        <tr>
          <td>image</td>
          <td>图像name</td>
        </tr>
      </table>
    </dd>
    <dt>参考代码</dt>
    <dd>
      <div>头像上传</div>
      <p>头像上传和其它业务分开，单独设计：没有采用 &lt;form&gt; 表单，所以使用自定义表单数据提交</p>
      <p>定制input/file，采用 - 移花接木 - 单独设计上传按钮</p>
      <p>封装上传函数</p>
      <p>可以略去header的配置</p>
      <p>样式略</p>
      <pre>
import { ref, onMounted } from 'vue'
import axios from 'axios';
let user = ref({})
let ipt = ref(null)

const submit = (e) => { }

const selectImg = () => {
  ipt.value.click();
}

const uploadIpt = (e) => {
  let file = e.target.files[0];
  uploadImg(file);
}

const uploadImg = (file) => {
  // 自定义表单数据
  let formData = new FormData()
  formData.append('image', file)
  axios.post('/api/uploadImg', formData, {
    headers: {
      'Content-Type': 'multipart/form-data'
    }
  })
    .then(res => {
      user.value.imgUrl = res.data.data.url;
    })
    .catch(err => {
      console.log('err', err);
    })
}

onMounted(() => {
  fetch('https://glpla.github.io/utils/data/user/24090503.json')
    .then(res => res.json())
    .then(data => {
      console.log(data);
      user.value = data
    })
})</pre>
      <pre>
&lt;div class="avatar"&gt;
  &lt;img :src="user.imgUrl" alt=""&gt;
  &lt;input type="file" name="image" ref="ipt" accept="image/*" hidden @change="uploadIpt"&gt;
  &lt;div class="avatar-btn" @click="selectImg"&gt;上传头像&lt;/div&gt;
&lt;/div&gt;</pre>
    </dd>
  </dl>
  <iframe src="../../common/footer.html" frameborder="0" scrolling="no" title="footer" id="footer"></iframe>
</body>

</html>