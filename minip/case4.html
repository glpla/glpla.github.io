<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>表单使用 Form</title>
    <link rel="stylesheet" href="../css/exp.css">
    <link rel="stylesheet" href="../css/code.css">
    <base target="_blank">
</head>

<body>
    <header>
    </header>
    <div class="container">
        <h1>注册/留言/问卷</h1>
        <h4>&commat;register</h4>
        <dl class="number-mul-sn">
            <dt>目的</dt>
            <dd>
                <div>掌握数据绑定的使用</div>
                <div>熟悉常见表单元素的事件</div>
                <div>了解表单提交和网络请求的基本过程</div>
            </dd>
            <dt>内容</dt>
            <dd>
                <div>数据绑定</div>
                <div>表单事件的使用</div>
                <div><a href="../node/jsonserver.html" class="link">json-server</a>服务器的搭建</div>
                <div>网络请求</div>
            </dd>
            <dt>要求</dt>
            <dd>
                <div>自行设计场景，完成留言、用户注册或问卷调查，并应用到小程序项目中</div>
                <div>三个应用案例完成一个即可，建议全部完成</div>
                <div>实验报告：采用学院统一下发的格式文件，以图片或代码形式展示并说明实施过程、各部分功能、具体内容和实现细节，并按照要求命名，最后导出为PDF，提交个人学习通作业</div>
                <div>未按要求在规定时间内提交视为无效，不得分</div>
            </dd>
            <dt>留言模块</dt>
            <dd>.婚礼邀请函案例</dd>
            <dd>
                <div>服务器支持 json-server</div>
                <div>数据文件 msg.json - info开发者信息；msg用户提交数据</div>
                <pre>
{
    "info": {},
    "msg": []
}</pre>
                <div>表单各字段名字name：用户姓名uname、用户性别ugender、用户电话ucell、用户邮箱umail、用户留言umsg</div>
                <div>效果图</div>
                <img src="./imgs/wedding3.png" alt="">
            </dd>
            <dt>用户注册模块</dt>
            <dd>
                <div>服务器支持 json-server</div>
                <div>数据文件 user.json - info开发者信息；user用户提交数据</div>
                <pre>
{
    "info": {},
    "user": []
}</pre>
                <div>使用组件</div>
                <p>.input - text/nickname</p>
                <p>.slider</p>
                <p>.picker</p>
                <p>.radio radio-group</p>
                <p>.checkbox checkbox-group</p>
                <p>.textarea</p>
                <p>.buttton - submit</p>
                <div>用户节点信息字段</div>
                <pre>
user:{
    id:20221001
    ubirth:'2020-08-01',
    udesc:'hi,there.',
    ulike:[],
    uage:18,
    ugender:'女',
    uname:'glpla',
}</pre>
                <div>提交代码 - 默认提交json，所以不需要额外指定header</div>
                <pre>
submit(e){
    wx.request({
        url: 'http://127.0.0.1:3000/user',
        method:'POST',
        data:this.data.user,
        success:(res)=>{
            console.log(res);
        },
        fail:err=>{
            console.log(err);
        }
    })
}</pre>
                <div>效果图</div>
                <img src="./imgs/setup0.png" alt="">
            </dd>
            <dt>问卷调查模块</dt>
            <dd>
                <div>服务器支持 json-server</div>
                <div>数据文件 survey.json - info开发者信息；survey用户提交数据</div>
                <pre>
{
    "info": {},
    "survey": []
}</pre>
                <div>问卷内容以小组为单位自定</div>
                <div>表单各字段名字name：用户姓名uname、用户邮箱umail、用户选择urx（x:1-n）、用户留言umsg</div>
                <div>表单提交事件处理函数 - 具体服务器地址视当时开发环境</div>
                <pre>
submitSurvey(e) {
    wx.request({
        url: 'http://127.0.0.1:3000/survey',
        method:'POST',
        data: e.detail.value,
        success:res=>{
        console.log(res);
        },
        fail:err=>{
        console.log(err);
        },
        complete:()=>{
        console.log('log done');
        }
    })
}                </pre>
                <div>效果图</div>
                <img src="./imgs/survey0.png" alt="">
                <img src="./imgs/survey1.png" alt="">
            </dd>
            <dt>扩展</dt>
            <dd>
                <div>使用node.js服务器，提交数据单独保存为一个文件</div>
                <pre>
const express = require('express')
const fs = require('fs');

// 创建Web服务器
const app = express();
const port = 3000;

// 静态资源；系统中间件-靠前引用；路由中间件
app
  .use(express.static('./public'))
  .use(express.json())

app.post('/userInfo', (req, res) => {
    console.log(req.body);
    fs.writeFile('./public/data/userInfo.json', JSON.stringify(req.body), (error) => {
        if (error) {
            console.log('保存文件失败了')
        }
    });
    res.json(req.body)
})

app.listen(port, () => {
  console.log('server is on at: http://127.0.0.1:3000');
});</pre>
                <div>如何改善用户体验？如加入各种提示信息</div>
                <p>. wx.showLoading()</p>
                <p>. wx.hideLoading()</p>
                <p>. wx.showToast()</p>
            </dd>
        </dl>
    </div>
    <iframe src="../common/footer.html" frameborder="0" scrolling="no" title="footer" id="footer"></iframe>
</body>

</html>