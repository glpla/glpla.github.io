<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>积分榜 Rank</title>
  <link rel="stylesheet" href="./css/rank.css">
</head>

<body>
  <div class="container">
    <nav>
      <span class="tab-item active">22软工</span>
      <span class="tab-item">22数媒</span>
      <div class="logo">
        <span class='iconfont icon-line-medalxunzhang-02 logo-icon'></span>
        <span class="logo-title">积分榜 <span class='iconfont icon-line-medalxunzhang-02'></span></span>
      </div>
    </nav>
    <div class="main">
      <div id="main"></div>
    </div>
    <footer>
      <h5>All Rights Reserved &copy; By Cnplaman 2022-2024</h5>
    </footer>
  </div>
  <script>
    let main = document.querySelector('#main');
    let tab = document.querySelectorAll('.tab-item')
    tab.forEach((item, ind) => {
      item.addEventListener('click', () => {
        loadData(`../utils/data/data2024/rank20240${ind + 1}.json`);
        tab.forEach(item => {
          item.classList.remove('active');
        })
        item.classList.toggle('active');
      })
    })
    loadData('../utils/data/data2024/rank202401.json')
    function loadData(url) {
      let stu = [];
      let str = '';
      let iconStr = "<span class='iconfont icon-star'></span>"
      fetch(url)
        .then(res => res.json())
        .then(res => {
          stu = [...res.cont];
          stu.sort((a, b) => { return b.ucredit - a.ucredit; })
          let str = stu.map((item, ind) => {
            return `<div class='item' style='--star:${item.ucredit}'>
          <span class='sn'>${item.usn}</span>
          <img class='img' src="../utils/avatar${item.uavatar}" alt="avatar">
          <span class='name'>${item.uname}</span>
          <div>${iconStr.repeat(item.ucredit)}</div>          
         </div>
          `
          }).join('')
          main.innerHTML = str;
        })
    }
    console.log('hi'.repeat(2));
  </script>
</body>

</html>